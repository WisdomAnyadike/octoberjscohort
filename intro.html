<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <div>
        <label for="provider"> Pick Provider: </label>
        <select name="provider" id="provider">
            <option value=""> choose provider </option>
            <option value="mtn"> MTN </option>
            <option value="glo"> GLO </option>
            <option value="airtel"> AIRTEL</option>
            <option value="9mobile"> 9MOBILE </option>
        </select>
    </div>

    <div>
        <label for="amount"> Pick Amount: </label>
        <select name="amount" id="amount">
            <option value=""> choose amount </option>
            <option value="100"> 100 </option>
            <option value="200"> 200 </option>
            <option value="500"> 500</option>
            <option value="1000"> 1000 </option>
        </select>
    </div>

    <button onclick="generatePin()">generate pin</button>
    <p> Pin: <span id="thePin"> no pin yet.. </span></p>



    <div><label for="loadcard"> Load Card: </label>
        <input type="text" id="loadcard" value="*311*pin#">
        <button onclick="loadRechargeCard()"> Load Card </button>
    </div>

    <p>mtn balance: <span id="mtnBalance"> </span> </p>
    <p> glo balance: <span id="gloBalance"> </span> </p>
    <p> 9mobile balance: <span id="nineMobileBalance"> </span> </p>
    <p> airtel balance: <span id="airtelBalance"> </span> </p>

</body>

</html>
<script>
    let cards = []

    let balances = {
        mtnBalance: 0,
        gloBalance: 0,
        nineMobileBalance: 0,
        airtelBalance: 0
    }



    function displayBalance() {

        for (const key in balances) {
            document.getElementById(key).innerHTML = balances[key]
        }

    }

    displayBalance()


    function generatePin() {
        let provider = document.getElementById('provider').value
        let amount = document.getElementById('amount').value
        let thePin = document.getElementById('thePin')
        if (!provider || !amount) {
            alert('all fields are mandatory')
        } else {
            let pin = ''

            for (let index = 0; index <= 11; index++) {
                let randomNum = Math.floor(Math.random() * 10)
                pin = pin + randomNum
            }

            thePin.innerHTML = pin


            let card = {
                pin,
                provider,
                amount,
                isUsed: false
            }

            cards.push(card)
            console.log(cards);
        }



    }

    function loadRechargeCard() {
        let twelveDigit = loadcard.value.trim().slice(5, 17)
        if (loadcard.value.trim() !== `*311*${twelveDigit}#`) {
            alert('invalid format')
        }



        else {
            console.log(twelveDigit); //764783938293789

            let foundCard

            for (let index = 0; index < cards.length; index++) {
                if (cards[index].pin === twelveDigit) {
                    foundCard = cards[index]
                    break
                }
            }


            if (!foundCard) {
                alert('invalid card')
                return
            }

            if (foundCard.isUsed) {
                alert('this card has already been used')
                return
            }

            alert(`you have successfully recharged ${foundCard.provider} of ${foundCard.amount} `)
            foundCard.isUsed = true

            if (foundCard.provider === 'mtn') {
                balances.mtnBalance += +foundCard.amount
            } else if (foundCard.provider === 'glo') {
                balances.gloBalance += +foundCard.amount
            } else if (foundCard.provider === 'airtel') {
                balances.airtelBalance += +foundCard.amount
            } else {
                balances.nineMobileBalance += +foundCard.amount
            }

            displayBalance()



        }



    }




    let myObj = { pin: '234567898376567', provider: 'mtn', amount: '1000' }

    for (const key in myObj) {
        console.log(key, myObj[key]);
    }




</script>