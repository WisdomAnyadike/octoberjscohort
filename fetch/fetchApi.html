<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link rel="stylesheet" href="fetch.css">
</head>

<body>


  <div class="container">



  </div>

</body>

</html>
<script>
  //method 1
  function getAllProducts(params) {
    fetch("https://dummyjson.com/products").then((response) => {
      return response.json()
    }).then((data) => {
      console.log(data.products);
    }).catch((err) => {
      console.log(err.message);
    })
  }

  getAllProducts()

  //method 2 
  async function getProducts() {
    document.querySelector('.container').innerHTML = 'loading...'
    try {
      let response = await fetch('https://dummyjson.com/products')
      let data = await response.json()
      console.log(data.products);
      document.querySelector('.container').innerHTML = ''
      data.products.forEach((productObj, i) => {




        document.querySelector('.container').innerHTML += ` <div class="card">
      <img
        src="${productObj.images[0]}"
        alt="" />
      <div class="card-body">
        <div class="row">
          <div class="card-title">
            <h4>${productObj.title.length > 15 ? productObj.title.slice(0, 12) + '...' : productObj.title}</h4>
            <h3>$${(productObj.price - ((productObj.discountPercentage / 100) * productObj.price)).toFixed(2)}</h3>
          </div>
          <div class="view-btn">
            <a  onclick="viewDetails(${i})">View Details</a>
          </div>
        </div>
        <hr />
        <p>
          ${productObj.description}
        </p>
        <div class="btn-group">
          <div class="btn">
            <a href=""> Buy Now </a>
          </div>
          <a href=""> Cancel</a>
        </div>
      </div>
    </div>`


      });




    } catch (err) {
      console.log(err.message);
    }
  }

  getProducts()




  function viewDetails(index) {
    document.querySelector('.container').innerHTML = 'loading...'

    fetch(`https://dummyjson.com/products/${index + 1}`).then((response) => {
      return response.json()
    }).then((data) => {
      console.log(data);
      document.querySelector('.container').innerHTML = `
  <button onclick="getProducts()"> go back </button>

  <img src="${data.images[0]}" width="400" height="400" /> 
  <p> ${data.description} </p>
 <p> ${data.category} </p>
 <p> ${data.brand || 'no brand'} </p>
 <p> $${(data.price - ((data.discountPercentage / 100) * data.price)).toFixed(2)} </p>
 
 
 `

    }).catch((err) => {
      console.log(err.message);
    })


  }


</script>